<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>funko</title><meta name="description" content="Documentation for funko"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">funko</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>funko</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#práctica-10---apis-asíncronas-de-gestión-del-sistema-de-ficheros-creación-de-procesos-y-creación-de-sockets-de-nodejs" id="práctica-10---apis-asíncronas-de-gestión-del-sistema-de-ficheros-creación-de-procesos-y-creación-de-sockets-de-nodejs" style="color: inherit; text-decoration: none;">
  <h1>Práctica 10 - APIs asíncronas de gestión del sistema de ficheros, creación de procesos y creación de sockets de Node.js</h1>
</a>

<a href="#indice" id="indice" style="color: inherit; text-decoration: none;">
  <h2>Indice</h2>
</a>
<ol>
<li><a href="#introducci%C3%B3n">Introducción</a></li>
<li><a href="#ejercicio1">Ejercicio1</a></li>
<li><a href="#ejercicio2">Ejercicio2</a></li>
<li><a href="#ejercicio3">Ejercicio3</a></li>
<li><a href="#conclusiones">conclusiones</a></li>
</ol>

<a href="#introducción" id="introducción" style="color: inherit; text-decoration: none;">
  <h2>Introducción</h2>
</a>
<p>En esta práctica nos toca trabajar con las APIs asíncronas de gestión del sistema de ficheros, creación de procesos y creación de sockets de Node.js. Para ello, haremos distintos ejercicios que nos permitirán entender mejor los funcionamientos.</p>
<p>Ejercicio1</p>
<p>En este primer ejercicio nos daban el siguiente código y entender el funcionmiento:</p>
<pre><code class="language-typescript"><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">access</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">, </span><span class="hl-2">watch</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> !== </span><span class="hl-4">3</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">];</span><br/><br/><span class="hl-1">  </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">      </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> is no longer watched`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>En este codigo se puede ver como primero se importan las funciones fs a utilizar. Tras esto, para el correcto funcionamiento del codigo se pide que en la ejecución del tenga un parametro extra el cual es el nombre de un fichero (por ejemplo: helloWorld.txt). Si no se cumple esta condición se muestra un mensaje de error.</p>
<p>Tras esto, llegamos al <strong>access</strong> el cual comprueba si el fichero existe o no y si el usuario que ejecuta el codigo tiene los permisos necesarios. Junto a este <strong>access</strong> se encuentra el nombre del fichero que se va a comprobar. y el <strong>constants.F_OK</strong>.</p>
<p>El <strong>constant</strong> es un objeto formado por una coleccion de constantes que representan los distintos tipos de verificacion que se pueden hacer en el <strong>access</strong>. En este caso, se utiliza el <strong>F_OK</strong> el cual comprueba si el fichero existe o no aunque tambien se puede utilizar el <strong>R_OK</strong> el cual comprueba si el fichero existe y si el usuario tiene permisos de lectura y tambien se puede utilizar el <strong>W_OK</strong> que es similar pero con permisos de escritura.</p>
<p>Si existe, se muestra un mensaje de que se va a empezar a observar el fichero con un <strong>watch</strong>. Tras esto, se muestra un mensaje de que el fichero ya no se observa.</p>
<p>Mientras el programa observa el fichero, si se modifica de alguna manera, se muestra un mensaje de que el fichero ha sido modificado de alguna manera. Dicho esto, para enter como funciona el <strong>watch</strong> miremos como se mueven por la webAPI y por la callbakc queue.</p>
<p>Una vez que se ejecuta el <strong>watch</strong> se mueve a la webAPI y se queda esperando a que se modifique el fichero. Cuando se modifica el fichero, se mueve a la callback queue y se ejecuta cuando le toca su turno en la cola con el mensaje de que el fichero se ha modificado.</p>
<p>Con todo esto explicado, un ejemplo de como funciona el codigo seria el siguiente:</p>
<ol>
<li>Se ejecuta el codigo poniendo como parametro el nombre de un fichero que existe.</li>
<li>el programa comprueba si el fichero existe y si el usuario tiene permisos de lectura.</li>
<li>ya comprobado y avisado de que va todo bien por el programa principal, se ejecuta el <strong>watch</strong> sobre el fichero.</li>
<li>el <strong>watch</strong> se mueve a la webAPI y se queda esperando a que se modifique el fichero.</li>
<li>nos colocamos en el fichero y lo modificamos de alguna manera. (escribiendo algo por ejemplo)</li>
<li>el <strong>watch</strong> detecta que el fichero se ha modificado y se mueve a la callback queue.</li>
<li>cuando le toca su turno en la cola, se ejecuta y muestra el mensaje de que el fichero se ha modificado.</li>
<li>ya mostrado el mensaje, el <strong>watch</strong> vuelve a colocarse en la webAPI y se queda esperando a que se modifique el fichero.</li>
<li>volvemos a modificar el fichero.</li>
<li>el fichero se modifica y el <strong>watch</strong> se mueve a la callback queue otra vez.</li>
<li>tras esperar en la cola, se ejecuta y muestra el mensaje de que el fichero se ha modificado.</li>
<li>al cerrar el programa, se muestra el mensaje de que el fichero ya no se observa y <strong>watch</strong> se cierra.</li>
</ol>

<a href="#ejercicio2" id="ejercicio2" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio2</h2>
</a>
<p>En este segundo ejercicio toca 2 programas que les pases un fichero y dependiendo de los parametros que le pases, te diga el numero de lineas, paralabras y/o caracteres que tiene el fichero. Los programas se haran, uno con pipes y otro con child_process.
El primero, con pipes, se hara de la siguiente manera:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">yargs</span><span class="hl-1">, { </span><span class="hl-2">Argv</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">hideBin</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs/helpers&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">access</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs/promises&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">spawn</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;child_process&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * interfaz de los argumentos</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">ruta</span><span class="hl-8"> ruta del archivo</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">lineas</span><span class="hl-8"> contar lineas</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">palabras</span><span class="hl-8"> contar palabras</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">caracteres</span><span class="hl-8"> contar caracteres</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-9">Arguments</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">ruta</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">lineas</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">palabras</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">caracteres</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Funcion que se encarga de contar las lineas, palabras y caracteres de un archivo usando pipes</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">argv</span><span class="hl-8"> argumentos</span><br/><span class="hl-8"> * </span><span class="hl-6">@returns</span><span class="hl-8"> void</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">yargs</span><span class="hl-1">(</span><span class="hl-5">hideBin</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">&lt;{</span><br/><span class="hl-1">    </span><span class="hl-2">ruta</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">lineas</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">palabras</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">caracteres</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  }&gt;(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;$0 &lt;ruta&gt;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;Contar líneas, palabras y caracteres de un archivo&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    (</span><span class="hl-2">yargsOption</span><span class="hl-1">: </span><span class="hl-9">Argv</span><span class="hl-1">&lt;</span><span class="hl-9">Arguments</span><span class="hl-1">&gt;) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">yargsOption</span><br/><span class="hl-1">        .</span><span class="hl-5">positional</span><span class="hl-1">(</span><span class="hl-3">&#39;ruta&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del archivo&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;lineas&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar líneas&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;palabras&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar palabras&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteres&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar caracteres&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">: </span><span class="hl-9">Arguments</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">salida</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">ruta</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">args</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">lineas</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">salida</span><span class="hl-1"> += </span><span class="hl-3">&#39;|Líneas&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-l&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">palabras</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">salida</span><span class="hl-1"> += </span><span class="hl-3">&#39;|Palabras&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-w&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">caracteres</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">salida</span><span class="hl-1"> += </span><span class="hl-3">&#39;|Caracteres|&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-c&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> === </span><span class="hl-4">0</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-lwc&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">salida</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">wc</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;wc&#39;</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">concat</span><span class="hl-1">([</span><span class="hl-2">filename</span><span class="hl-1">]));</span><br/><span class="hl-1">        </span><span class="hl-2">wc</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">error</span><span class="hl-1">(</span><span class="hl-3">`El archivo </span><span class="hl-6">${</span><span class="hl-2">argv</span><span class="hl-10">.</span><span class="hl-2">ruta</span><span class="hl-6">}</span><span class="hl-3"> no existe`</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-5">demandCommand</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-5">parse</span><span class="hl-1">();</span>
</code></pre>
<p>Como podemos ver, el codigo es bastante largo y no es muy legible. Para explicar como funciona, vamos a verlo paso a paso.</p>
<p>Lo primero que se ve es una pequeña interfaz que se encarga de definir los argumentos que se le pasan al programa. En este caso, la ruta del archivo, si se quiere contar lineas, palabras y/o caracteres.</p>
<p>tras esto inicia el programa donde lo primero que se contemplan son los yargs. En este caso, se usa el <strong>hideBin</strong> para que no se muestre el nombre del programa en la ayuda. Luego se usa el <strong>command</strong> para definir el comando que se va a usar. En este caso, el comando es el nombre del programa y se le pasa la ruta del archivo. Luego se usa el <strong>positional</strong> para definir la ruta del archivo y se le pasa la descripcion y el tipo de dato. Por ultimo, se usan los <strong>option</strong> para definir si se quiere contar lineas, palabras y/o caracteres. En este caso, en cada opcion se usa el <strong>default</strong> para que si no se le pasa ningun parametro no se tenga en cuenta este al estar a false.</p>
<p>Una vez con los comandos establecidos, se pasa a la funcion que se ejecuta cuando se ejecuta el comando. En este caso, se usa el <strong>async</strong> para que se pueda usar el <strong>await</strong>. Lo primero que se hace es definir la salida que se va a mostrar en la consola. Luego se comprueba si el archivo existe y si el usuario tiene permisos de lectura. Si no existe o no tiene permisos, se muestra un mensaje de error y se sale del programa. Si todo va bien, se crea un array de strings que se usara para pasar los parametros al comando <strong>wc</strong>. Luego se comprueba si se quiere contar lineas, palabras y/o caracteres. Si se quiere contar lineas, se añade el parametro <strong>-l</strong> al array de parametros y se añade la palabra <strong>Líneas</strong> a la salida. Si se quiere contar palabras, se añade el parametro <strong>-w</strong> al array de parametros y se añade la palabra <strong>Palabras</strong> a la salida. Si se quiere contar caracteres, se añade el parametro <strong>-c</strong> al array de parametros y se añade la palabra <strong>Caracteres</strong> a la salida. Si no se quiere contar nada, se añade el parametro <strong>-lwc</strong> al array de parametros.</p>
<p>El segundo codigo, con child_process, se hara de la siguiente manera:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">yargs</span><span class="hl-1">, { </span><span class="hl-2">Argv</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">hideBin</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs/helpers&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">access</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs/promises&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">spawn</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;child_process&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * interfaz de los argumentos</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">ruta</span><span class="hl-8"> ruta del archivo</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">lineas</span><span class="hl-8"> contar lineas</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">palabras</span><span class="hl-8"> contar palabras</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">caracteres</span><span class="hl-8"> contar caracteres</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-9">Arguments</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">ruta</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">lineas</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">palabras</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-2">caracteres</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * Funcion que se encarga de contar las lineas, palabras y caracteres de un archivo usando child_process</span><br/><span class="hl-8"> * </span><span class="hl-6">@param</span><span class="hl-8"> </span><span class="hl-2">argv</span><span class="hl-8"> argumentos</span><br/><span class="hl-8"> * </span><span class="hl-6">@returns</span><span class="hl-8"> void</span><br/><span class="hl-8"> */</span><br/><span class="hl-5">yargs</span><span class="hl-1">(</span><span class="hl-5">hideBin</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">&lt;{</span><br/><span class="hl-1">    </span><span class="hl-2">ruta</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">lineas</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">palabras</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">caracteres</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">  }&gt;(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;$0 &lt;ruta&gt;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;Contar líneas, palabras y caracteres de un archivo&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    (</span><span class="hl-2">yargsOption</span><span class="hl-1">: </span><span class="hl-9">Argv</span><span class="hl-1">&lt;</span><span class="hl-9">Arguments</span><span class="hl-1">&gt;) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">yargsOption</span><br/><span class="hl-1">        .</span><span class="hl-5">positional</span><span class="hl-1">(</span><span class="hl-3">&#39;ruta&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del archivo&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;lineas&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar líneas&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;palabras&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar palabras&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-5">option</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteres&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">          </span><span class="hl-2">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Contar caracteres&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">default:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">: </span><span class="hl-9">Arguments</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">try</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">salida</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">ruta</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">args</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">lineas</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-l&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">palabras</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-w&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">caracteres</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-c&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> === </span><span class="hl-4">0</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">push</span><span class="hl-1">(</span><span class="hl-3">&#39;-lwc&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">wc</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;wc&#39;</span><span class="hl-1">, </span><span class="hl-2">args</span><span class="hl-1">.</span><span class="hl-5">concat</span><span class="hl-1">([</span><span class="hl-2">filename</span><span class="hl-1">]));</span><br/><br/><span class="hl-1">        </span><span class="hl-2">wc</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><br/><span class="hl-1">        </span><span class="hl-2">wc</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><br/><span class="hl-1">        </span><span class="hl-2">wc</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, (</span><span class="hl-2">code</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`El proceso de wc ha finalizado con el código </span><span class="hl-6">${</span><span class="hl-2">code</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-0">catch</span><span class="hl-1"> (</span><span class="hl-2">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">error</span><span class="hl-1">(</span><span class="hl-3">`El archivo </span><span class="hl-6">${</span><span class="hl-2">argv</span><span class="hl-10">.</span><span class="hl-2">ruta</span><span class="hl-6">}</span><span class="hl-3"> no existe`</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-5">demandCommand</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-5">parse</span><span class="hl-1">();</span>
</code></pre>
<p>Como podemos ver, el codigo es similar al anterior pero en esta ocacion usamos el <strong>spawn</strong>.</p>
<p>Tras pasar la parte de yargs, que es igual, se pasa a la funcion que se ejecuta cuando se ejecuta el comando. En este caso, se usa el <strong>async</strong> tambien para que se pueda usar el <strong>await</strong>. Lo primero que se hace es definir la salida que se va a mostrar en la consola. Luego se comprueba si el archivo existe y si el usuario tiene permisos de lectura. Si no existe o no tiene permisos, se muestra un mensaje de error y se sale del programa. Si todo va bien, se crea un array de strings que se usara para pasar los parametros al comando <strong>wc</strong>. Luego se comprueba si se quiere contar lineas, palabras y/o caracteres. Si se quiere contar lineas, se añade el parametro <strong>-l</strong> al array de parametros y se añade la palabra <strong>Líneas</strong> a la salida. Si se quiere contar palabras, se añade el parametro <strong>-w</strong> al array de parametros y se añade la palabra <strong>Palabras</strong> a la salida. Si se quiere contar caracteres, se añade el parametro <strong>-c</strong> al array de parametros y se añade la palabra <strong>Caracteres</strong> a la salida. Si no se quiere contar nada, se añade el parametro <strong>-lwc</strong> al array de parametros. Para finalizar, en vez de usar <strong>pipes</strong> como en el codigo anterior, hacemos un &quot;wc.stdout.on(&#39;data&#39;, (data) =&gt; {})&quot; y dentro de esto, se muestra la salida por consola.</p>

<a href="#ejercicio3" id="ejercicio3" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio3</h2>
</a>
<p>en este ejercicio teniamos que usar la practica anterior de la base de datos de funkos y hacer un cliente y un servidor. El cliente se encargaria de recibir los parametros por comandos y de enviar peticiones al servidor y el servidor se encargaria de responder a las peticiones del cliente haciendo todo lo necesario.</p>
<p>para evitar que este informe sea innecesariamente largo, solo voy a explicar el funcionamiento del cliente y del servidor pues es lo nuevo que se ha hecho en esta practica.</p>

<a href="#cliente" id="cliente" style="color: inherit; text-decoration: none;">
  <h3>Cliente</h3>
</a>
<p>Como anteriormente mencioné, el cliente es el que interactua con el usuario, ya sea recibiendo los parametros por comandos o mostrando los resultados de las peticiones al servidor. El codigo del cliente es el siguiente:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">net</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;net&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">Funko</span><span class="hl-1">, </span><span class="hl-2">Tipo</span><span class="hl-1">, </span><span class="hl-2">Genero</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/Funko.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">ColeccionFunkos</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/ColeccionFunkos.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Usuario</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Usuario/Usuario.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">chalk</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;chalk&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">yargs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">hideBin</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs/helpers&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">ColeccionDatos</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/ColeccionDatos.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">exit</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;process&#39;</span><span class="hl-1">;</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">log</span><span class="hl-1"> = </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">;</span><br/><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">client</span><span class="hl-1"> = </span><span class="hl-2">net</span><span class="hl-1">.</span><span class="hl-5">createConnection</span><span class="hl-1">({ </span><span class="hl-2">port:</span><span class="hl-1"> </span><span class="hl-4">60300</span><span class="hl-1">, </span><span class="hl-2">allowHalfOpen:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> });</span><br/><br/><span class="hl-8">//enivamos el comando al servidor</span><br/><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;connect&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">yargs</span><span class="hl-1">(</span><span class="hl-5">hideBin</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  </span><span class="hl-8">//comando para añadir un funko a la base de datos</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">(</span><span class="hl-3">&#39;add&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Adds a funko&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-2">usuario:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Usuario&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">   </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko ID&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">   </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">   </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">nombre:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Nombre&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">descripcion:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Descripcion&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">tipo:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Tipo&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">genero:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Genero&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">franquicia:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Franquicia&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">numero:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Numero Franquicia&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">exclusivo:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Exclusivo&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">caracteristicas:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Caracteristicas&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">valor:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Precio&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">    </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">    </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">  },</span><br/><span class="hl-1"> }, (</span><span class="hl-2">argv</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">//enviamos los datos al servidor</span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({</span><span class="hl-3">&#39;type&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;id&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;nombre&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;descripcion&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;tipo&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;genero&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;franquicia&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;numero&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;exclusivo&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;caracteristicas&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;valor&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">&#39;usuario&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">}</span><br/><span class="hl-1">  ));</span><br/><span class="hl-1">  </span><span class="hl-8">//recibimos y mostramos el string del servidor</span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1">){</span><br/><span class="hl-1">      </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">greenBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko añadido correctamente&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    }</span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">      </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">redBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Error al añadir el funko&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">(</span><span class="hl-3">&#39;delete&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Deletes a funko&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">usuario:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Usuario&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko ID&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  }, (</span><span class="hl-2">argv</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//enviamos los datos al servidor</span><br/><span class="hl-1">    </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({</span><span class="hl-3">&#39;type&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;delete&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;id&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;usuario&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">}</span><br/><span class="hl-1">    ));</span><br/><span class="hl-1">    </span><span class="hl-8">//recibimos y mostramos el string del servidor</span><br/><span class="hl-1">    </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1">){</span><br/><span class="hl-1">        </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">greenBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko eliminado correctamente&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">        </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">redBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Error al eliminar el funko&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">(</span><span class="hl-3">&#39;update&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Updates a funko&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">usuario:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Usuario&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">     </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko ID&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">     </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">     </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">nombre:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Nombre&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">descripcion:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Descripcion&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">tipo:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Tipo&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">genero:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Genero&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">franquicia:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Franquicia&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">numero:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Numero Franquicia&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">exclusivo:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Exclusivo&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;boolean&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">caracteristicas:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Caracteristicas&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-2">valor:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko Precio&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">   }, (</span><span class="hl-2">argv</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//enviamos los datos al servidor</span><br/><span class="hl-1">    </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({</span><span class="hl-3">&#39;type&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;update&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;id&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;nombre&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;descripcion&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;tipo&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;genero&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;franquicia&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;numero&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;exclusivo&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;caracteristicas&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;valor&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;usuario&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">}</span><br/><span class="hl-1">  ));</span><br/><span class="hl-1">  </span><span class="hl-8">//recibimos y mostramos el string del servidor</span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1">){</span><br/><span class="hl-1">      </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">greenBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko actualizado correctamente&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    }</span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">      </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">redBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Error al actualizar el funko&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1">(</span><span class="hl-3">&#39;list&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Lists all funkos&#39;</span><span class="hl-1">, {}, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//enviamos los datos al servidor</span><br/><span class="hl-1">    </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({</span><span class="hl-3">&#39;type&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;list&#39;</span><span class="hl-1">}</span><br/><span class="hl-1">  ));</span><br/><span class="hl-1">  </span><span class="hl-8">//recibimos y mostramos el string del servidor</span><br/><span class="hl-1">  </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//creamos la coleccion de datos con los datos recibidos</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">respuesta</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">coleccionDatos</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ColeccionDatos</span><span class="hl-1">(</span><span class="hl-2">respuesta</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">coleccionDatos</span><span class="hl-1">.</span><span class="hl-5">getDatos</span><span class="hl-1">().</span><span class="hl-5">forEach</span><span class="hl-1">((</span><span class="hl-2">usuario</span><span class="hl-1">:</span><span class="hl-9">ColeccionFunkos</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">blue</span><span class="hl-1">(</span><span class="hl-3">&#39;Usuario: &#39;</span><span class="hl-1">+</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">getDuenioColeccion</span><span class="hl-1">()));</span><br/><span class="hl-1">      </span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">getFunkos</span><span class="hl-1">().</span><span class="hl-5">forEach</span><span class="hl-1">((</span><span class="hl-2">funko</span><span class="hl-1">:</span><span class="hl-9">Funko</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">() &lt;= </span><span class="hl-4">10</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko: &#39;</span><span class="hl-1">+</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">()));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">() &lt;= </span><span class="hl-4">20</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">() &gt; </span><span class="hl-4">10</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko: &#39;</span><span class="hl-1">+</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">()));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">() &lt;= </span><span class="hl-4">30</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">() &gt; </span><span class="hl-4">20</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko: &#39;</span><span class="hl-1">+</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">()));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">white</span><span class="hl-1">(</span><span class="hl-3">&#39;Funko: &#39;</span><span class="hl-1">+</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">()));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-5">command</span><span class="hl-1"> (</span><span class="hl-3">&#39;show&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Shows a funko&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">usuario:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Usuario&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">      </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">      </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-2">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">description:</span><span class="hl-1"> </span><span class="hl-3">&#39;Funko ID&#39;</span><span class="hl-1">, </span><span class="hl-8">//descripcion del campo</span><br/><span class="hl-1">        </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;number&#39;</span><span class="hl-1">, </span><span class="hl-8">//tipo de dato del campo</span><br/><span class="hl-1">        </span><span class="hl-2">demandOption:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> </span><span class="hl-8">//dice si el campo es obligatorio o no</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        }, (</span><span class="hl-2">argv</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-8">//enviamos los datos al servidor</span><br/><span class="hl-1">        </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({</span><span class="hl-3">&#39;type&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&#39;show&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-3">&#39;id&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-3">&#39;usuario&#39;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">}</span><br/><span class="hl-1">      ));</span><br/><span class="hl-1">      </span><span class="hl-8">//recibimos y mostramos el string del servidor</span><br/><span class="hl-1">      </span><span class="hl-2">client</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">        </span><span class="hl-8">//console.log(response);</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> &lt;= </span><span class="hl-4">10</span><span class="hl-1">){</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;id:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;nombre:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;descripcion:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;tipo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;genero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;franquicia:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;numero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;exclusivo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteristicas:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;valor:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">));</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> &lt;= </span><span class="hl-4">20</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> &gt; </span><span class="hl-4">10</span><span class="hl-1">){</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;id:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;nombre:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;descripcion:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;tipo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;genero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;franquicia:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;numero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;exclusivo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteristicas:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">yellow</span><span class="hl-1">(</span><span class="hl-3">&#39;valor:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">));</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> &lt;= </span><span class="hl-4">30</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> &gt; </span><span class="hl-4">20</span><span class="hl-1">){</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;id:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;nombre:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;descripcion:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;tipo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;genero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;franquicia:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;numero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;exclusivo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteristicas:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">magenta</span><span class="hl-1">(</span><span class="hl-3">&#39;valor:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">));</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;id:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;nombre:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;descripcion:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;tipo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;genero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;franquicia:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;numero:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;exclusivo:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;caracteristicas:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">red</span><span class="hl-1">(</span><span class="hl-3">&#39;valor:&#39;</span><span class="hl-1">+</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">));</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        }</span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">          </span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">redBright</span><span class="hl-1">(</span><span class="hl-3">&#39;Error al eliminar el funko&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  </span><span class="hl-8">//const message = JSON.parse(dataJSON.toString());</span><br/><span class="hl-1">  </span><span class="hl-8">//console.log(message);</span><br/><span class="hl-1">  .</span><span class="hl-5">help</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-2">argv</span><span class="hl-1">;</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Como se ve en el codigo, el cliente se conecta al servidor y envia un JSON con el tipo de peticion que se quiere realizar, el tipo de peticion puede ser:</p>
<ol>
<li><strong>add</strong> para añadir un funko.</li>
<li><strong>delete</strong> para eliminar un funko.</li>
<li><strong>update</strong> para actualizar un funko.</li>
<li><strong>list</strong> para listar todos los funkos.</li>
<li><strong>show</strong> para mostrar un funko en concreto.
dependiendo del tipo de peticion, el servidor realiza una accion u otra, y devuelve un JSON con la respuesta de la peticion, el cliente recibe el JSON y lo muestra por pantalla.
en los primeros 3 casos, el servidor devuelve un JSON con un aviso indicando el resultado de la peticion, en el caso de <strong>list</strong> devuelve un JSON con todos los funkos, y en el caso de <strong>show</strong> devuelve un JSON con el funko que se ha pedido.</li>
</ol>
<p>Por otra parte, el servidor se encarga de crear la base de datos, recibir los JSON del cliente, realizar las acciones correspondientes y devolver el JSON con la respuesta.</p>
<p>el codigo del servidor es el siguiente:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">net</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;net&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">watchFile</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">Funko</span><span class="hl-1">, </span><span class="hl-2">Tipo</span><span class="hl-1">, </span><span class="hl-2">Genero</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/Funko.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">ColeccionFunkos</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/ColeccionFunkos.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Usuario</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Usuario/Usuario.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">chalk</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;chalk&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">yargs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">hideBin</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;yargs/helpers&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">ColeccionDatos</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;./Funko/ColeccionDatos.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">createReadStream</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">createWriteStream</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">exit</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;process&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">access</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;node:fs&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Console</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;console&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">resolveNs</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;dns&#39;</span><span class="hl-1">;</span><br/><span class="hl-8">//import { number } from &#39;yargs&#39;;</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">log</span><span class="hl-1"> = </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">;</span><br/><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ColeccionDatos</span><span class="hl-1">([]);</span><br/><br/><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-9">ColeccionDeDatos</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">funkos</span><span class="hl-1">: </span><span class="hl-9">Funko</span><span class="hl-1">[];</span><br/><span class="hl-1">  </span><span class="hl-2">Duenio</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * funcion para crear la base de datos</span><br/><span class="hl-8"> * </span><span class="hl-6">@returns</span><span class="hl-8"> void</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-5">crearBaseDatos</span><span class="hl-1">(){</span><br/><span class="hl-1">  </span><span class="hl-8">//comprueba si existe el directorio datos</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1">(!</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos&#39;</span><span class="hl-1">)){</span><br/><span class="hl-1">    </span><span class="hl-8">//si no existe lo crea</span><br/><span class="hl-1">    </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">mkdirSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-8">//lee los directorios del directorio datos y crea objetos usuario con cada nombre</span><br/><span class="hl-1">  </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">readdirSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos&#39;</span><span class="hl-1">).</span><span class="hl-5">forEach</span><span class="hl-1">(</span><span class="hl-2">folder</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Usuario</span><span class="hl-1">(</span><span class="hl-2">folder</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">ColeccionFunkos1</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ColeccionFunkos</span><span class="hl-1">([],</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-8">//lee los archivos json de cada directorio y crea objetos funko con cada uno</span><br/><span class="hl-1">    </span><span class="hl-8">//esos funkos los añade a la coleccion de funkos del usuario</span><br/><span class="hl-1">    </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">readdirSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">folder</span><span class="hl-1">).</span><span class="hl-5">forEach</span><span class="hl-1">(</span><span class="hl-2">file</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-8">//crea el objeto funko con los datos del archivo json</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">funko</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">readFileSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">folder</span><span class="hl-1">+</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">+</span><span class="hl-2">file</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">funkoJson</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">tipo</span><span class="hl-1"> = </span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">Tipo</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Tipo</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">genero</span><span class="hl-1"> = </span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">Genero</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Genero</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">funkoObjeto</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Funko</span><span class="hl-1">(</span><span class="hl-5">parseInt</span><span class="hl-1">(</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">),</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">,</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">,</span><span class="hl-2">genero</span><span class="hl-1">,</span><span class="hl-2">tipo</span><span class="hl-1">,</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">Franquicia</span><span class="hl-1">,</span><span class="hl-5">parseInt</span><span class="hl-1">(</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">idFranquicia</span><span class="hl-1">),</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">,</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">,</span><span class="hl-5">parseInt</span><span class="hl-1">(</span><span class="hl-2">funkoJson</span><span class="hl-1">.</span><span class="hl-2">valorNumerico</span><span class="hl-1">));</span><br/><span class="hl-1">      </span><span class="hl-8">//añade el funko a la coleccion de funkos del usuario</span><br/><span class="hl-1">      </span><span class="hl-2">ColeccionFunkos1</span><span class="hl-1">.</span><span class="hl-5">aniadirFunko</span><span class="hl-1">(</span><span class="hl-2">funkoObjeto</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-8">//añade la coleccion de funkos del usuario a la coleccion de datos</span><br/><span class="hl-1">    </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">aniadirDatos</span><span class="hl-1">(</span><span class="hl-2">ColeccionFunkos1</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * funcion para guardar la base de datos</span><br/><span class="hl-8"> * </span><span class="hl-6">@returns</span><span class="hl-8"> void</span><br/><span class="hl-8"> * */</span><br/><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">(){</span><br/><span class="hl-1">  </span><span class="hl-8">//para cada coleccion de funkos de la coleccion de datos</span><br/><span class="hl-1">  </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatos</span><span class="hl-1">().</span><span class="hl-5">forEach</span><span class="hl-1">(</span><span class="hl-2">coleccion</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//busca el directorio del usuario y guarda los datos de cada funko en un archivo json</span><br/><span class="hl-1">    </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">readdirSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos&#39;</span><span class="hl-1">).</span><span class="hl-5">forEach</span><span class="hl-1">(</span><span class="hl-2">folder</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">folder</span><span class="hl-1"> == </span><span class="hl-2">coleccion</span><span class="hl-1">.</span><span class="hl-5">getDuenioColeccion</span><span class="hl-1">()){</span><br/><span class="hl-1">        </span><span class="hl-2">coleccion</span><span class="hl-1">.</span><span class="hl-5">getFunkos</span><span class="hl-1">().</span><span class="hl-5">forEach</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">writeFileSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">folder</span><span class="hl-1">+</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">+</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetId</span><span class="hl-1">()+</span><span class="hl-3">&#39;.json&#39;</span><span class="hl-1">,</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">));</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span><br/><br/><br/><span class="hl-2">net</span><span class="hl-1">.</span><span class="hl-5">createServer</span><span class="hl-1">((</span><span class="hl-2">connection</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">//recibe el mensaje del cliente</span><br/><span class="hl-1">  </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">//analiza el tipo de mensaje</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">mensaje</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">parse</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-5">crearBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-2">success:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">data:</span><span class="hl-1"> </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-4">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">nombre:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">descripcion:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">tipo:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">genero:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">franquicia:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">numero:</span><span class="hl-1"> </span><span class="hl-4">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">exclusivo:</span><span class="hl-1"> </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">caracteristicas:</span><span class="hl-1"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">valor:</span><span class="hl-1"> </span><span class="hl-4">0</span><span class="hl-1">,</span><br/><span class="hl-1">    };</span><br/><br/><span class="hl-1">    </span><span class="hl-8">//si el mensaje es de tipo add</span><br/><span class="hl-1">    </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">type</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-3">&#39;add&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">tipo</span><span class="hl-1"> = </span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Tipo</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">genero</span><span class="hl-1"> = </span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Genero</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-8">//crea el objeto funko con los datos del comando</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Usuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-8">//busca si hay un funko con el mismo id</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">) != </span><span class="hl-6">undefined</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-8">//si existe envia un mensaje de error al cliente</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-8">//comprueba si existe un funko con el mismo numero de franquicia y mismo nombre de franquicia</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">Funko</span><span class="hl-1">.</span><span class="hl-2">idFranquicia</span><span class="hl-1">.</span><span class="hl-5">has</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">idFranquicia</span><span class="hl-1">) &amp;&amp; </span><span class="hl-2">Funko</span><span class="hl-1">.</span><span class="hl-2">Franquicia</span><span class="hl-1">.</span><span class="hl-5">has</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">Franquicia</span><span class="hl-1">)){</span><br/><span class="hl-1">          </span><span class="hl-8">//si existe envia un mensaje de error al cliente</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-8">//comprueba si el valor numerico es un numero negativo</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">valorNumerico</span><span class="hl-1"> &lt; </span><span class="hl-4">0</span><span class="hl-1">){</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">          </span><span class="hl-8">//si existe envia un mensaje de error al cliente</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">funko</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Funko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">genero</span><span class="hl-1">,</span><span class="hl-2">tipo</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">,</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-8">//comprueba si existe el usuario y si no lo crea</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(!</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)){</span><br/><span class="hl-1">          </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">mkdirSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">NuevaColeccionFunkos</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">ColeccionFunkos</span><span class="hl-1">([</span><span class="hl-2">funko</span><span class="hl-1">],</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">());</span><br/><span class="hl-1">          </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">aniadirDatos</span><span class="hl-1">(</span><span class="hl-2">NuevaColeccionFunkos</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">          </span><span class="hl-8">//si el usuario ya existe añade el funko a su coleccion</span><br/><span class="hl-1">          </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)?.</span><span class="hl-5">aniadirFunko</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-8">//guarda todos los datos en los archivos json</span><br/><span class="hl-1">        </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-8">//envia un mensaje de confirmacion al cliente</span><br/><span class="hl-1">        </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">        </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-3">&#39;delete&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">        </span><span class="hl-8">//comprueba si existe el usuario</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)){</span><br/><span class="hl-1">        </span><span class="hl-8">//compueba si existe el funko con ese id</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">) == </span><span class="hl-6">undefined</span><span class="hl-1">){            </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-8">//si existe borra el funko de la coleccion de funkos del usuario</span><br/><span class="hl-1">          </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)?.</span><span class="hl-5">eliminarFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-8">//borra el archivo json del funko</span><br/><span class="hl-1">          </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">unlink</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">+</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">+</span><span class="hl-3">&#39;.json&#39;</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">error</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          })</span><br/><span class="hl-1">            </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-8">//guarda todos los datos en los archivos json</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-3">&#39;update&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1">(!</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">user</span><span class="hl-1">)){</span><br/><span class="hl-1">          </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Usuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-8">//compueba si existe el funko con ese id</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)){</span><br/><span class="hl-1">            </span><span class="hl-8">//modifica el funko con los datos del comando</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetNombre</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetDescripcion</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetTipo</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Tipo</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetGenero</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Genero</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetFranquicia</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetIdFranquicia</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetExclusivo</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetCaracteristicas</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatosUsuario</span><span class="hl-1">(</span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">())?.</span><span class="hl-5">getFunko</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">)?.</span><span class="hl-5">SetValorNumerico</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">            </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">            </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">            </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">else</span><span class="hl-1">{</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-5">guardarBaseDatos</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-3">&#39;list&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">data</span><span class="hl-1"> = </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">          </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-3">&#39;show&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">          </span><span class="hl-8">//comprueba si existe el usuario</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-3">&#39;./datos/&#39;</span><span class="hl-1">+</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">)){</span><br/><span class="hl-1">            </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-5">Usuario</span><span class="hl-1">(</span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">usuario</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-8">//compueba si existe el funko con ese id</span><br/><span class="hl-1">            </span><span class="hl-2">ColeccionDatos1</span><span class="hl-1">.</span><span class="hl-5">getDatos</span><span class="hl-1">()?.</span><span class="hl-5">forEach</span><span class="hl-1">((</span><span class="hl-2">usuario</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-8">//busca un funko con ese id con funcion find</span><br/><span class="hl-1">              </span><span class="hl-2">usuario</span><span class="hl-1">.</span><span class="hl-5">getFunkos</span><span class="hl-1">().</span><span class="hl-5">find</span><span class="hl-1">((</span><span class="hl-2">funko</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetId</span><span class="hl-1">() == </span><span class="hl-2">mensaje</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1">){</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">id</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetId</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">nombre</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetNombre</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">descripcion</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetDescripcion</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">tipo</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetTipo</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">genero</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetGenero</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">franquicia</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetFranquicia</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">numero</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetIdFranquicia</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">exclusivo</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetExclusivo</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">caracteristicas</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetCaracteristicas</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">valor</span><span class="hl-1"> = </span><span class="hl-2">funko</span><span class="hl-1">.</span><span class="hl-5">GetValorNumerico</span><span class="hl-1">();</span><br/><span class="hl-1">                  </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">                  </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">              })</span><br/><span class="hl-1">              </span><span class="hl-8">//si no existe el funko con ese id</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> == </span><span class="hl-6">false</span><span class="hl-1">){</span><br/><span class="hl-1">                </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">                </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">write</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">));</span><br/><span class="hl-1">                </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">end</span><span class="hl-1">();</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;connect&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-2">chalk</span><span class="hl-1">.</span><span class="hl-5">green</span><span class="hl-1">(</span><span class="hl-3">&#39;Client connected&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-2">connection</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;end&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Client disconnected&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}).</span><span class="hl-5">listen</span><span class="hl-1">(</span><span class="hl-4">60300</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Waiting for clients to connect.&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>
<p>como podemos ver, y al igual que pasa con el cliente, este codigo es bastante similar al index de la practica anterior, pues el servidor al crearse, crea la base de datos, y cada vez que modifica algo, vuelve a guardar los datos en los archivos json. El servidor tambien tiene un switch case, que dependiendo del comando que reciba, ejecutara una funcion u otra. Por ejemplo, si recibe un comando de tipo &quot;add&quot;, añadira un funko a la coleccion del usuario, y si recibe un comando de tipo &quot;delete&quot;, borrara el funko de la coleccion del usuario. El servidor tambien tiene un switch case para los comandos de tipo &quot;list&quot;, &quot;show&quot; y &quot;update&quot;, que son los que se usan para listar los funkos de un usuario, mostrar un funko en concreto, y modificar un funko en concreto respectivamente.</p>
<p>A diferencia de en la practica anterior, en esta los mensajes tienen que ser enviados al client, por lo que no podemos usar los clasicos console.log, sino que tenemos que usar la funcion connection.write, que es la que se encarga de enviar los mensajes al cliente, en los primeros casos solo enviamos un booleano aunque en las funciones de tipo &quot;list&quot; y &quot;show&quot; enviamos tambien los datos.</p>
<p>##Conclusiones</p>
<p>En lineas generales el uso de los hilos me parece algo de especial utilidad pues puedes hacer que varios programas iteractuen entre ellos, y que puedan ejecutarse al mismo tiempo, o que por ejemplo se puedan tener simultaneamente varias funciones interactuando sin necesidad de que una termine para que comience la otra.</p>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">funko</a>
<ul>
<li class="tsd-kind-module"><a href="modules/ejer2_child.html">ejer2/child</a></li>
<li class="tsd-kind-module"><a href="modules/ejer2_pipes.html">ejer2/pipes</a></li>
<li class="tsd-kind-module"><a href="modules/ejer3_Funko_ColeccionDatos.html">ejer3/<wbr/>Funko/<wbr/>Coleccion<wbr/>Datos</a></li>
<li class="tsd-kind-module"><a href="modules/ejer3_Funko_ColeccionFunkos.html">ejer3/<wbr/>Funko/<wbr/>Coleccion<wbr/>Funkos</a></li>
<li class="tsd-kind-module"><a href="modules/ejer3_Funko_Funko.html">ejer3/<wbr/>Funko/<wbr/>Funko</a></li>
<li class="tsd-kind-module"><a href="modules/ejer3_Usuario_Usuario.html">ejer3/<wbr/>Usuario/<wbr/>Usuario</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>